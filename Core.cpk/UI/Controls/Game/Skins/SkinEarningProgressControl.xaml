<base:BaseUserControl x:Class="AtomicTorch.CBND.CoreMod.UI.Controls.Game.Skins.SkinEarningProgressControl"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                      xmlns:base="clr-namespace:AtomicTorch.GameEngine.Common.Client.MonoGame.UI;assembly=AtomicTorch.CBND.GameApi.WPF.Stubs"
                      xmlns:loc="clr-namespace:AtomicTorch.CBND.CoreMod.UI"
                      xmlns:data="clr-namespace:AtomicTorch.CBND.CoreMod.UI.Controls.Game.Skins.Data"
                      xmlns:core="clr-namespace:AtomicTorch.CBND.CoreMod.UI.Controls.Core"
                      mc:Ignorable="d"
                      d:DesignHeight="300" d:DesignWidth="300"
                      d:DataContext="{d:DesignInstance data:ViewModelSkinEarningProgressControl}">
    <Grid Visibility="{Binding IsVisible, Converter={StaticResource BoolToVisibilityConverter}}">
        <Grid.Resources>
            <Style x:Key="TextBlockHeaderStyle" TargetType="TextBlock">
                <Setter Property="FontFamily" Value="{StaticResource CondensedFontFamily}" />
                <Setter Property="TextAlignment" Value="Left" />
                <Setter Property="TextWrapping" Value="Wrap" />
                <Setter Property="FontWeight" Value="Bold" />
                <Setter Property="LineStackingStrategy" Value="BlockLineHeight" />
                <Setter Property="FontSize" Value="18" />
                <Setter Property="LineHeight" Value="18" />
                <Setter Property="Foreground" Value="{StaticResource BrushColor6}" />
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="Margin" Value="7,7,7,4" />
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect
                            BlurRadius="20"
                            Direction="0"
                            ShadowDepth="0"
                            Opacity="0.6"
                            Color="{StaticResource Color7}" />
                    </Setter.Value>
                </Setter>
            </Style>

            <Storyboard x:Key="StoryboardIconSkinReadyToClaimAnimation"
                        AutoReverse="True"
                        RepeatBehavior="Forever">
                <DoubleAnimationUsingKeyFrames
                    Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                    Storyboard.TargetName="IconSkinReadyToClaim">
                    <EasingDoubleKeyFrame KeyTime="0" Value="0.97" />
                    <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="1.03">
                        <EasingDoubleKeyFrame.EasingFunction>
                            <SineEase EasingMode="EaseOut" />
                        </EasingDoubleKeyFrame.EasingFunction>
                    </EasingDoubleKeyFrame>
                </DoubleAnimationUsingKeyFrames>

                <DoubleAnimationUsingKeyFrames
                    Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                    Storyboard.TargetName="IconSkinReadyToClaim">
                    <EasingDoubleKeyFrame KeyTime="0" Value="0.97" />
                    <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="1.03">
                        <EasingDoubleKeyFrame.EasingFunction>
                            <SineEase EasingMode="EaseOut" />
                        </EasingDoubleKeyFrame.EasingFunction>
                    </EasingDoubleKeyFrame>
                </DoubleAnimationUsingKeyFrames>
            </Storyboard>
        </Grid.Resources>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <TextBlock Grid.ColumnSpan="2"
                   Text="{x:Static loc:CoreStrings.Skins_FreeSkinProgress_Title}"
                   Style="{StaticResource TextBlockHeaderStyle}" />

        <core:ValueBarControl
            Grid.Row="1"
            Grid.Column="0"
            Value="{Binding ProgressBarValueCurrent}"
            MaxValue="{Binding ProgressBarValueMax}"
            IsValueInterpolated="False"
            Width="484"
            Height="12"
            Padding="2"
            IsDisplayLabel="False"
            IsDisplayTooltip="False"
            BorderThickness="1"
            HorizontalAlignment="Left"
            Margin="7,0,0,0">

            <core:ValueBarControl.BorderBrush>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="{StaticResource Color4}" Offset="0" />
                    <GradientStop Color="{StaticResource Color6}" Offset="1" />
                </LinearGradientBrush>
            </core:ValueBarControl.BorderBrush>

            <!-- bar -->
            <Border CornerRadius="2">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="{StaticResource Color4}" Offset="0" />
                        <GradientStop Color="{StaticResource Color7}" Offset="1" />
                    </LinearGradientBrush>
                </Border.Background>
            </Border>

            <core:ValueBarControl.Background>
                <SolidColorBrush Color="{StaticResource Color1}"
                                 Opacity="0.6" />
            </core:ValueBarControl.Background>

            <core:ValueBarControl.Template>
                <ControlTemplate TargetType="{x:Type core:ValueBarControl}">
                    <Grid x:Name="LayoutRoot">
                        <Border x:Name="Border"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="{TemplateBinding Background}"
                                CornerRadius="3" />

                        <ContentPresenter HorizontalAlignment="Left"
                                          Margin="{TemplateBinding Padding}" />

                        <!-- Ticks overlay -->
                        <ItemsControl ItemsSource="{Binding TicksEnumeration}"
                                      Margin="1,2">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid Columns="{Binding TicksCount}" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Rectangle Width="2"
                                               Margin="0,0,-1,0"
                                               UseLayoutRounding="False"
                                               HorizontalAlignment="Right">
                                        <Rectangle.Fill>
                                            <LinearGradientBrush Opacity="0.4"
                                                                 StartPoint="0,0"
                                                                 EndPoint="1,0">
                                                <GradientStop Color="{StaticResource Color5}" Offset="0" />
                                                <GradientStop Color="{StaticResource Color5}" Offset="0.5" />
                                                <GradientStop Color="Black" Offset="0.5001" />
                                                <GradientStop Color="Black" Offset="1.0" />
                                            </LinearGradientBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <!--<Rectangle RadiusX="3"
                                   RadiusY="3"
                                   Margin="0,2,3,2"
                                   UseLayoutRounding="False">
                            <Rectangle.Fill>
                                <LinearGradientBrush Opacity="0.4"
                                                     SpreadMethod="Repeat"
                                                     StartPoint="0,0"
                                                     EndPoint="69,0"
                                                     MappingMode="Absolute">
                                    <GradientStop Color="Transparent" Offset="0" />
                                    <GradientStop Color="Transparent" Offset="0.97" />
                                    <GradientStop Color="{StaticResource Color5}" Offset="0.9701" />
                                    <GradientStop Color="{StaticResource Color5}" Offset="0.985" />
                                    <GradientStop Color="Black" Offset="0.9851" />
                                    <GradientStop Color="Black" Offset="1.0" />
                                </LinearGradientBrush>
                            </Rectangle.Fill>
                        </Rectangle>-->
                    </Grid>
                </ControlTemplate>
            </core:ValueBarControl.Template>
        </core:ValueBarControl>

        <core:FormattedTextBlock Grid.Row="2"
                                 Grid.Column="0"
                                 Text="{Binding ProgressText}"
                                 Visibility="{Binding CanClaimEarnedSkin, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Reverse}"
                                 Foreground="{StaticResource BrushColorLabelForeground}"
                                 FontFamily="{StaticResource DefaultFontFamily}"
                                 FontSize="12"
                                 FontWeight="Bold"
                                 VerticalAlignment="Bottom"
                                 HorizontalAlignment="Right"
                                 Margin="0,0,0,11" />

        <Button Grid.Row="2"
                Grid.Column="0"
                Content="{x:Static loc:CoreStrings.Skins_ClaimUnlockedSkin}"
                Command="{Binding CommandClaimEarnedSkin}"
                Visibility="{Binding CanClaimEarnedSkin, Converter={StaticResource BoolToVisibilityConverter}}"
                Focusable="False"
                Padding="3,2"
                VerticalAlignment="Bottom"
                HorizontalAlignment="Right"
                Margin="0,0,0,11" />

        <!-- Inactive gift icon -->
        <ContentControl
            Visibility="{Binding CanClaimEarnedSkin, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Reverse}"
            Width="96"
            Height="96"
            Grid.Row="0"
            Grid.RowSpan="3"
            Grid.Column="1"
            Margin="10,0,3,0">
            <Path Fill="{StaticResource BrushColorAlt5}"
                  Data="M3 2.5a2.5 2.5 0 0 1 5 0 2.5 2.5 0 0 1 5 0v.006c0 .07 0 .27-.038.494H15a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h2.038A2.968 2.968 0 0 1 3 2.506V2.5zm1.068.5H7v-.5a1.5 1.5 0 1 0-3 0c0 .085.002.274.045.43a.522.522 0 0 0 .023.07zM9 3h2.932a.56.56 0 0 0 .023-.07c.043-.156.045-.345.045-.43a1.5 1.5 0 0 0-3 0V3zm6 4v7.5a1.5 1.5 0 0 1-1.5 1.5H9V7h6zM2.5 16A1.5 1.5 0 0 1 1 14.5V7h6v9H2.5z"
                  Width="64"
                  Height="64"
                  Stretch="Uniform"
                  VerticalAlignment="Center"
                  HorizontalAlignment="Center">
                <Path.Effect>
                    <!-- Glow effect -->
                    <DropShadowEffect
                        BlurRadius="40"
                        Direction="0"
                        ShadowDepth="0"
                        Opacity="0.4"
                        Color="#FF41858E" />
                </Path.Effect>
            </Path>
        </ContentControl>

        <!-- Active gift icon (ready to claim) -->
        <ContentControl x:Name="IconSkinReadyToClaim"
                        Visibility="{Binding CanClaimEarnedSkin, Converter={StaticResource BoolToVisibilityConverter}}"
                        Width="96"
                        Height="96"
                        Grid.Row="0"
                        Grid.RowSpan="3"
                        Grid.Column="1"
                        Margin="10,0,3,0"
                        RenderTransformOrigin="0.5,0.5">
            <Path Fill="{StaticResource BrushColorAlt7}"
                  Data="M3 2.5a2.5 2.5 0 0 1 5 0 2.5 2.5 0 0 1 5 0v.006c0 .07 0 .27-.038.494H15a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h2.038A2.968 2.968 0 0 1 3 2.506V2.5zm1.068.5H7v-.5a1.5 1.5 0 1 0-3 0c0 .085.002.274.045.43a.522.522 0 0 0 .023.07zM9 3h2.932a.56.56 0 0 0 .023-.07c.043-.156.045-.345.045-.43a1.5 1.5 0 0 0-3 0V3zm6 4v7.5a1.5 1.5 0 0 1-1.5 1.5H9V7h6zM2.5 16A1.5 1.5 0 0 1 1 14.5V7h6v9H2.5z"
                  Width="64"
                  Height="64"
                  Stretch="Uniform"
                  VerticalAlignment="Center"
                  HorizontalAlignment="Center">
                <Path.Effect>
                    <!-- Glow effect -->
                    <DropShadowEffect
                        BlurRadius="40"
                        Direction="0"
                        ShadowDepth="0"
                        Opacity="0.4"
                        Color="#FF41858E" />
                </Path.Effect>
            </Path>
            <ContentControl.RenderTransform>
                <ScaleTransform ScaleX="1" ScaleY="1" />
            </ContentControl.RenderTransform>
        </ContentControl>
        <Grid.Triggers>
            <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                <BeginStoryboard Storyboard="{StaticResource StoryboardIconSkinReadyToClaimAnimation}" />
            </EventTrigger>
        </Grid.Triggers>
    </Grid>
</base:BaseUserControl>