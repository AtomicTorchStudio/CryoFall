<base:BaseUserControl x:Class="AtomicTorch.CBND.CoreMod.UI.Controls.Menu.Servers.RateEditorControl"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                      xmlns:base="clr-namespace:AtomicTorch.GameEngine.Common.Client.MonoGame.UI;assembly=AtomicTorch.CBND.GameApi.WPF.Stubs"
                      xmlns:data="clr-namespace:AtomicTorch.CBND.CoreMod.UI.Controls.Menu.Servers.Data"
                      xmlns:loc="clr-namespace:AtomicTorch.CBND.CoreMod.UI"
                      xmlns:client="clr-namespace:AtomicTorch.CBND.CoreMod.Helpers.Client"
                      xmlns:core="clr-namespace:AtomicTorch.CBND.CoreMod.UI.Controls.Core"
                      mc:Ignorable="d"
                      d:DesignHeight="300" d:DesignWidth="300"
                      d:DataContext="{d:DesignInstance data:IViewModelRate}"
                      Width="250">
    <base:BaseUserControl.Resources>

        <Style x:Key="TextBlockRateIdStyle"
               TargetType="{x:Type TextBlock}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="TextWrapping" Value="NoWrap" />
            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
            <Setter Property="FontFamily" Value="{StaticResource MonospacedFontFamily}" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="LineHeight" Value="12" />
        </Style>

        <Style x:Key="TextBlockRateTitleStyle"
               TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontFamily" Value="{StaticResource CondensedFontFamily}" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="LineHeight" Value="11" />
            <Setter Property="LineStackingStrategy" Value="BlockLineHeight" />
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
            <Setter Property="Text" Value="{Binding Name}" />
            <Setter Property="base:ToolTipServiceExtend.ToolTip">
                <Setter.Value>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{Binding Id}"
                                   Style="{StaticResource TextBlockRateIdStyle}" />
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                Text="{Binding ValueDefaultText, StringFormat={x:Static loc:CoreStrings.RatesEditorControl_DefaultRateValueFormat}}" />
                        </StackPanel>
                    </StackPanel>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CustomButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource BrushColorAlt6}" />
            <Setter Property="MinWidth" Value="1" />
            <Setter Property="MinHeight" Value="1" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,-2,0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Padding="2"
                                CornerRadius="1"
                                BorderThickness="1"
                                Background="Transparent"
                                x:Name="Border">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background"
                                        TargetName="Border">
                                    <Setter.Value>
                                        <SolidColorBrush Color="{StaticResource Color3}" Opacity="0.3" />
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="BorderBrush"
                                        TargetName="Border"
                                        Value="{StaticResource BrushColor6}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background"
                                        TargetName="Border">
                                    <Setter.Value>
                                        <SolidColorBrush Color="{StaticResource Color4}" Opacity="0.45" />
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="BorderBrush"
                                        TargetName="Border"
                                        Value="{StaticResource BrushColor7}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground"
                            Value="{StaticResource BrushColor6}" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Foreground"
                            Value="{StaticResource BrushColor6}" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ButtonSetDefaultStyle"
               TargetType="Button"
               BasedOn="{StaticResource CustomButtonStyle}">
            <Setter Property="Command" Value="{Binding CommandSetDefault}" />
            <Setter Property="base:ToolTipServiceExtend.ToolTip">
                <Setter.Value>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{x:Static loc:CoreStrings.Button_Reset}" FontWeight="Bold" />
                        <TextBlock
                            Text="{Binding ValueDefaultText, StringFormat={x:Static loc:CoreStrings.RatesEditorControl_DefaultRateValueFormat}}" />
                    </StackPanel>
                </Setter.Value>
            </Setter>
            <Setter Property="Visibility"
                    Value="{Binding IsDefaultValue, Converter={StaticResource BoolToHiddenVisibilityConverter}, ConverterParameter=Reverse}" />
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Path x:Name="Path"
                              Data="M 32.299968,0.45486638 C 21.574312,9.5609786 11.010957,18.857881 0.60052092,28.322627 -0.98020791,34.625794 7.2320112,37.05067 10.395065,41.222625 c 7.470538,6.513276 14.715735,13.301888 22.57328,19.3566 6.162744,1.205776 5.278905,-6.806526 5.123546,-10.70303 0,-1.697027 0,-3.394055 0,-5.091082 12.709813,0.706782 25.978146,3.874848 35.920991,12.21303 5.340543,4.586249 8.482483,12.636674 4.83118,19.204001 -3.080023,6.368767 -9.257727,10.457346 -15.389216,13.543934 -3.557778,5.248277 5.565102,4.057834 7.765743,1.623895 C 83.188959,86.158786 95.095796,77.603284 99.105027,64.587775 102.44335,53.282007 96.585727,41.230793 87.696834,34.207928 74.498032,22.939902 57.159425,17.933923 40.220434,15.916499 34.791046,13.490352 40.634335,5.5395425 36.988054,1.339231 35.878238,0.03015437 33.808254,-0.36858449 32.299968,0.45486638 Z"
                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                              Stretch="Uniform"
                              Width="8"
                              Height="8" />
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ButtonUnlockRangeStyle"
               TargetType="Button"
               BasedOn="{StaticResource CustomButtonStyle}">
            <Setter Property="Command"
                    Value="{Binding CommandToggleExpandedRange}" />
            <Setter Property="base:ToolTipServiceExtend.ToolTip">
                <Setter.Value>
                    <core:FormattedTextBlock Text="{Binding TextUnlockExpandedRange}" />
                </Setter.Value>
            </Setter>
            <Setter Property="Visibility"
                    Value="{Binding IsExpandedRangeAvailable, Converter={StaticResource BoolToHiddenVisibilityConverter}}" />
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Path x:Name="Path"
                              Data="m 186.26668,237.06667 q 0,-14.02292 -9.92189,-23.94479 Q 166.42292,203.2 152.4,203.2 q -14.02292,0 -23.94479,9.92188 -9.92188,9.92187 -9.92188,23.94479 0,9.78958 5.02709,17.72708 5.02708,7.9375 13.49375,12.43542 l -18.25625,60.58958 q -1.32292,3.96875 1.32291,7.40833 2.64584,3.43959 6.87917,3.43959 h 50.8 q 4.23335,0 6.87918,-3.43959 2.64583,-3.43958 1.32292,-7.40833 l -18.25627,-60.58958 q 8.46667,-4.49792 13.49377,-12.43542 5.02708,-7.9375 5.02708,-17.72708 z M 84.66667,169.33333 h 135.46668 v -50.8 q 0,-28.045831 -19.84375,-47.889581 -19.84375,-19.84375 -47.8896,-19.84375 -28.04583,0 -47.88958,19.84375 -19.84375,19.84375 -19.84375,47.889581 z m 220.13334,25.4 v 152.4 q 0,10.58334 -7.40833,17.99167 -7.40833,7.40833 -17.99167,7.40833 H 25.4 q -10.583333,0 -17.991667,-7.40833 Q 0,357.71667 0,347.13333 v -152.4 Q 0,184.15 7.408333,176.74167 14.816667,169.33333 25.4,169.33333 h 8.46667 v -50.8 q 0,-48.683331 34.925,-83.608331 Q 103.71667,0 152.4,0 q 48.68335,0 83.60835,34.924999 34.925,34.925 34.925,83.608331 v 50.8 h 8.46666 q 10.58334,0 17.99167,7.40834 7.40833,7.40833 7.40833,17.99166 z"
                              IsHitTestVisible="False"
                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                              Stretch="Uniform"
                              Width="8"
                              Height="8" />
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsExpandedRangeUnlocked}" Value="True">
                    <Setter Property="base:ToolTipServiceExtend.ToolTip">
                        <Setter.Value>
                            <core:FormattedTextBlock Text="{Binding TextResetRange}" />
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Foreground"
                            Value="{StaticResource BrushColorRed6}" />
                    <Setter Property="ContentTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <Path x:Name="Path"
                                      Data="m 152.40051,0 c 32.45555,0 60.32604,11.642701 83.60937,34.926034 23.28333,23.28333 35.40479,28.808554 35.40479,61.264103 L 225.42655,107.95 c 0,-18.697219 -11.90625,-24.07605 -25.13542,-37.305216 -13.22917,-13.22917 -29.1934,-19.84375 -47.89062,-19.84375 -18.69723,0 -34.65938,6.61458 -47.88855,19.84375 C 91.282794,83.87395 84.668213,99.836114 84.668213,118.53333 v 50.80052 H 279.40051 c 7.05556,0 13.0533,2.46944 17.99218,7.40833 4.93889,4.93889 7.40834,10.93457 7.40834,17.99012 v 152.4005 c 0,7.05556 -2.46945,13.0533 -7.40834,17.9922 -4.93888,4.93889 -10.93662,7.40833 -17.99218,7.40833 H 25.400502 c -7.055537,0 -13.053271,-2.46944 -17.9921688,-7.40833 C 2.4694356,360.1861 0,354.18836 0,347.1328 V 194.7323 c 0,-7.05555 2.4694356,-13.05123 7.4083332,-17.99012 4.9388978,-4.93889 10.9366318,-7.40833 17.9921688,-7.40833 h 8.467196 v -50.80052 c 0,-32.455549 11.642188,-60.323966 34.925516,-83.607296 C 92.076544,11.642701 119.94494,0 152.40051,0 Z m 0,203.19896 c -9.34861,0 -17.33073,3.30729 -23.94531,9.92188 -6.61458,6.61458 -9.92187,14.59721 -9.92187,23.94582 0,6.52639 1.67621,12.43438 5.0276,17.72605 3.3514,5.29167 7.84982,9.43733 13.49427,12.43592 l -18.25625,60.58959 c -0.88194,2.64583 -0.44149,5.11529 1.3224,7.40833 1.76389,2.29306 4.05642,3.43958 6.87865,3.43958 h 50.80103 c 2.82222,0 5.11528,-1.14652 6.87917,-3.43958 1.76389,-2.29304 2.20383,-4.7625 1.32188,-7.40833 l -18.25573,-60.58959 c 5.64445,-2.99859 10.14287,-7.14425 13.49426,-12.43592 3.35139,-5.29167 5.02709,-11.19966 5.02709,-17.72605 0,-9.34861 -3.30729,-17.33124 -9.92188,-23.94582 -6.61458,-6.61459 -14.5967,-9.92188 -23.94531,-9.92188 z"
                                      IsHitTestVisible="False"
                                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                      Stretch="Uniform"
                                      Width="8"
                                      Height="8" />
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <ControlTemplate x:Key="SliderWithTextBoxDataTemplate">
            <ContentControl x:Name="Root"
                            Margin="-10,0"
                            Background="Transparent"
                            VerticalAlignment="Center">
                <Grid Margin="10,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Foreground="{StaticResource BrushColorAltLabelForeground}"
                               Style="{StaticResource TextBlockRateTitleStyle}" />

                    <StackPanel Grid.Row="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Margin="0,0,0,-2">
                        <Button Style="{StaticResource ButtonSetDefaultStyle}"
                                Margin="0" />
                        <ContentControl
                            Visibility="{Binding IsMouseOver, Converter={StaticResource BoolToHiddenVisibilityConverter}, ElementName=Root}"
                            Margin="2,0,0,0">
                            <Button Style="{StaticResource ButtonUnlockRangeStyle}"
                                    Margin="0" />
                        </ContentControl>
                    </StackPanel>

                    <Grid Grid.Row="1"
                          HorizontalAlignment="Stretch"
                          d:DataContext="{d:DesignInstance data:ViewModelRateDouble}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <Grid Grid.Column="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="x"
                                       Visibility="{Binding IsMultiplier, Converter={StaticResource BoolToVisibilityConverter}}"
                                       FontFamily="{StaticResource MonospacedFontFamily}"
                                       FontSize="11"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="0,0,2,0" />
                            <TextBox Grid.Column="1"
                                     Text="{Binding Value, StringFormat=0.##}"
                                     FontSize="11"
                                     FontWeight="Bold"
                                     FontFamily="{StaticResource MonospacedFontFamily}"
                                     HorizontalAlignment="Stretch"
                                     VerticalAlignment="Center"
                                     Margin="0"
                                     Padding="1,2.5"
                                     MinWidth="0"
                                     MinHeight="0"
                                     AcceptsReturn="False" />
                            <TextBlock Grid.Column="2"
                                       Text="{x:Static client:ClientTimeFormatHelper.SuffixSeconds}"
                                       Visibility="{Binding IsDurationSeconds, Converter={StaticResource BoolToVisibilityConverter}}"
                                       FontFamily="{StaticResource MonospacedFontFamily}"
                                       FontSize="11"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="2,0,0,0" />
                        </Grid>

                        <Slider Grid.Column="2"
                                Value="{Binding Value}"
                                Minimum="{Binding ValueMin}"
                                Maximum="{Binding ValueMax}"
                                SmallChange="{Binding ValueSliderSmallChange}"
                                LargeChange="{Binding ValueSliderSmallChange}"
                                IsSnapToTickEnabled="{Binding IsExpandedRangeUnlocked, Converter={StaticResource BoolReverseConverter}}"
                                TickFrequency="{Binding ValueSliderSmallChange}"
                                HorizontalAlignment="Stretch"
                                Margin="-3,-5,20,-5" />
                    </Grid>
                </Grid>
            </ContentControl>
        </ControlTemplate>

        <ControlTemplate x:Key="TextBoxDataTemplate">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0"
                           Foreground="{StaticResource BrushColorAltLabelForeground}"
                           Style="{StaticResource TextBlockRateTitleStyle}" />

                <Button Grid.Row="1"
                        Style="{StaticResource ButtonSetDefaultStyle}"
                        HorizontalAlignment="Right"
                        Margin="0,0,-2,-3" />

                <Grid Grid.Row="1"
                      HorizontalAlignment="Stretch"
                      Margin="0,3,20,0">
                    <TextBox Text="{Binding Value}"
                             FontSize="11"
                             FontFamily="{StaticResource MonospacedFontFamily}"
                             HorizontalAlignment="Stretch"
                             VerticalAlignment="Center"
                             Margin="0"
                             Padding="1,2.5"
                             MinWidth="0"
                             MinHeight="0"
                             AcceptsReturn="False" />
                </Grid>
            </Grid>
        </ControlTemplate>
    </base:BaseUserControl.Resources>

    <Border Padding="10,3">
        <Border.Style>
            <Style TargetType="{x:Type Border}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsDefaultValue}"
                                 Value="False">
                        <Setter Property="Background">
                            <Setter.Value>
                                <SolidColorBrush Color="{StaticResource ColorAlt1}" Opacity="0.7" />
                            </Setter.Value>
                        </Setter>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Border.Style>

        <ContentControl Content="{Binding}">
            <ContentControl.Resources>
                <DataTemplate DataType="{x:Type data:ViewModelRateDouble}">
                    <ContentControl Template="{StaticResource SliderWithTextBoxDataTemplate}" />
                </DataTemplate>

                <DataTemplate DataType="{x:Type data:ViewModelRateInt}">
                    <ContentControl Template="{StaticResource SliderWithTextBoxDataTemplate}" />
                </DataTemplate>

                <DataTemplate DataType="{x:Type data:ViewModelRateUint}">
                    <ContentControl Template="{StaticResource SliderWithTextBoxDataTemplate}" />
                </DataTemplate>

                <DataTemplate DataType="{x:Type data:ViewModelRateUshort}">
                    <ContentControl Template="{StaticResource SliderWithTextBoxDataTemplate}" />
                </DataTemplate>

                <DataTemplate DataType="{x:Type data:ViewModelRateByte}">
                    <ContentControl Template="{StaticResource SliderWithTextBoxDataTemplate}" />
                </DataTemplate>

                <DataTemplate DataType="{x:Type data:ViewModelRateBoolean}">
                    <Grid Background="Transparent"
                          VerticalAlignment="Center">
                        <CheckBox IsChecked="{Binding Value}"
                                  Focusable="False">
                            <CheckBox.Content>
                                <TextBlock Foreground="{StaticResource BrushColorAltLabelForeground}"
                                           Style="{StaticResource TextBlockRateTitleStyle}"
                                           base:ToolTipServiceExtend.ToolTip="{x:Null}" />
                            </CheckBox.Content>
                        </CheckBox>
                        <Button Style="{StaticResource ButtonSetDefaultStyle}"
                                HorizontalAlignment="Right" />
                        <base:ToolTipServiceExtend.ToolTip>
                            <StackPanel Orientation="Vertical">
                                <TextBlock Text="{Binding Id}"
                                           Style="{StaticResource TextBlockRateIdStyle}" />
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock
                                        Text="{Binding ValueDefaultText, StringFormat={x:Static loc:CoreStrings.RatesEditorControl_DefaultRateValueFormat}}" />
                                </StackPanel>
                            </StackPanel>
                        </base:ToolTipServiceExtend.ToolTip>
                    </Grid>
                </DataTemplate>

                <DataTemplate DataType="{x:Type data:ViewModelRateString}">
                    <ContentControl Template="{StaticResource TextBoxDataTemplate}" />
                </DataTemplate>
            </ContentControl.Resources>
        </ContentControl>
    </Border>
</base:BaseUserControl>